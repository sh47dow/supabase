
-- USERS
CREATE TYPE public.user_status AS ENUM ('ONLINE', 'OFFLINE');
CREATE TABLE public.users (
  id bigint GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  inserted_at timestamp without time zone DEFAULT timezone('utc'::text, now()) NOT NULL,
  updated_at timestamp without time zone DEFAULT timezone('utc'::text, now()) NOT NULL,
  data jsonb DEFAULT null,
  username text
  status public.users.data DEFAULT 'ONLINE'::public.user_status
);

COMMENT ON TABLE public.users.data IS 'For unstructured data and prototyping.';




-- ROOMS
CREATE TABLE public.rooms (
  id bigint GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  inserted_at timestamp without time zone DEFAULT timezone('utc'::text, now()) NOT NULL,
  updated_at timestamp without time zone DEFAULT timezone('utc'::text, now()) NOT NULL,
  data jsonb DEFAULT null,
  slug text,
  owner_id bigint REFERENCES users NOT NULL
);
COMMENT ON TABLE public.users.data IS 'For unstructured data and prototyping.';

-- Create the Replication publication 
CREATE PUBLICATION supabase_realtime FOR ALL TABLES;